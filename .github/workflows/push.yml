name: Redstone Push Commit

on:
  push:
    branches:
      - 'master'

jobs:
  build:
    runs-on: self-hosted
    steps:
      - name: Clone Repo
        run: |
          cd ..
          rm -rf Redstone/!(.tmp)/
          git clone -q https://github.com/stickz/Redstone
        
      - name: Branch Commit History
        run: |
          git branch -D history
          git branch history 6df183e
        continue-on-error: true

      - name: Run Chmod
        run: chmod 777 .github/scripts/build.sh

      - name: Build Stable
        run: ./.github/scripts/build.sh -v --sourcemod=1.10.0-6453 --out=build
        shell: bash
